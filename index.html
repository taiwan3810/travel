<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>æ˜“ç¶“å¦è±¡è¼¸å…¥èˆ‡æ”¯å¦é¡¯ç¤º</title>
  <!-- éŸ¿æ‡‰å¼è¨­å®š -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- ??? lunar-javascript (CDN + local fallback), Vue.js ??html2canvas -->
  <script src="https://cdn.jsdelivr.net/npm/lunar-javascript@1.7.7/dist/lunar.min.js"
          onerror="this.onerror=null;var s=document.createElement('script');s.src='./lunar.min.js';document.head.appendChild(s);"></script>
  <script src="https://cdn.jsdelivr.net/npm/vue@2"></script>
  <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
  <style>
    body {
      font-family: "KaiTi", "STKaiti", "BiauKai", "Georgia", serif;
      background-color: #f9f7f2;
      color: #2c2c2c;
      margin: 20px;
    }
    h1, h2, h3 {
      text-align: center;
      font-weight: normal;
    }
    /* æç¤ºè¨Šæ¯ */
    .hint {
      text-align: center;
      font-size: 0.95em;
      color: #555;
      margin-bottom: 10px;
    }
    /* ä»Šå¤©æ™‚åˆ»è¼¸å…¥å€ */
    .time-input {
      margin: 20px auto;
      text-align: center;
    }
    .time-input select {
      width: 50px;
      text-align: center;
      margin: 0 5px;
      background: transparent;
      border: none;
      border-bottom: 2px solid #555;
      font-family: inherit;
      font-size: 1em;
      border-radius: 0;
    }
    .time-input span {
      margin: 0 5px;
      font-weight: bold;
    }
    .kongwang {
      margin-top: 5px;
      font-size: 0.9em;
      color: #2c3e50;
    }
    /* æ ¸å°é¸é … */
    .options {
      text-align: center;
      margin: 10px 0;
      font-size: 0.9em;
    }
    .options label {
      margin: 0 10px;
    }
    /* æŒ‰éˆ• */
    .btn-save {
      display: block;
      margin: 20px auto;
      padding: 10px 24px;
      font-size: 1.1em;
      cursor: pointer;
      background-color: #b22222;
      color: #fff;
      border: none;
      border-radius: 2px;
      font-family: inherit;
    }
    /* å¤–å±¤å®¹å™¨ */
    .hexagrams-wrapper {
      display: flex;
      flex-wrap: wrap;
      justify-content: space-around;
      align-items: flex-start;
      margin-top: 20px;
    }
    .hexagram {
      padding: 20px;
      border: 2px solid #4a4a4a;
      background-color: #fff;
      box-shadow: 5px 5px 0px rgba(0,0,0,0.1);
      min-width: 320px;
      flex: 1 1 320px;
      margin: 10px;
    }
    /* å…±åŒçˆ»å®¹å™¨ */
    .lines-container {
      display: flex;
      flex-direction: column-reverse;
    }
    .line, .support-line {
      display: flex;
      align-items: center;
      margin: 5px 0;
      height: 50px;
    }
    /* å…­ç¸æ¨™ç±¤ */
    .beast-label {
      width: 60px;
      text-align: left;
      margin-right: 10px;
      font-weight: bold;
      color: #2c3e50;
    }
    .line-label {
      width: 60px;
      text-align: right;
      margin-right: 10px;
      font-weight: bold;
    }
    /* å°åœ“åœˆ */
    .circle {
      width: 18px;
      height: 18px;
      border-radius: 50%;
      background-color: transparent;
      cursor: pointer;
      border: 2px solid #555;
      margin-right: 10px;
    }
    .circle.active {
      background-color: #b22222;
      border-color: #b22222;
    }
    /* çˆ»å½¢ç‹€ */
    .line-shape {
      cursor: pointer;
      position: relative;
      color: #2c2c2c;
    }
    .line-shape.is-moving {
      color: #b22222;
    }
    .yang-line {
      width: 60px;
      height: 10px;
      background-color: currentColor;
      margin-bottom: 2px;
    }
    .yin-line-container {
      width: 60px;
      height: 10px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 2px;
    }
    .yin-line-rect {
      width: 20px;
      height: 10px;
      background-color: currentColor;
    }
    /* åˆ¤å®šæè¿°ï¼šç©ºäº¡èˆ‡æ²–ï¼å»ºåŠäº”è¡Œåˆ¤å®š */
    .empty-label {
      margin-left: 10px;
      font-size: 0.85em;
      color: #b22222;
      display: block;
    }
    .month-empty-label {
      margin-left: 10px;
      font-size: 0.85em;
      color: #cd5c5c;
      display: block;
    }
    .chongjian-label {
      margin-left: 10px;
      font-size: 0.85em;
      color: #8b8b00;
      display: block;
    }
    .liuQin-container {
      margin-left: 10px;
      font-size: 0.85em;
      color: #444;
      white-space: nowrap;
    }
    .fuShen {
      font-size: 0.75em;
      color: #2c3e50;
      margin-top: 2px;
    }
    .shiYing {
      font-size: 0.8em;
      color: #b22222;
    }
    /* Prompt å®¹å™¨ */
    .prompt-container {
      padding: 20px;
      border: 2px solid #4a4a4a;
      background-color: #fff;
      box-shadow: 5px 5px 0px rgba(0,0,0,0.1);
      margin: 20px auto;
      max-width: 90%;
    }
    .prompt-textarea {
      width: 100%;
      min-height: 200px;
      padding: 15px;
      font-family: "KaiTi", "STKaiti", "BiauKai", "Georgia", serif;
      font-size: 0.95em;
      line-height: 1.8;
      border: 1px solid #ccc;
      border-radius: 4px;
      background-color: #f9f7f2;
      color: #2c2c2c;
      resize: vertical;
      cursor: text;
    }
    .prompt-textarea:focus {
      outline: 2px solid #b22222;
      background-color: #fff;
    }
    .btn-copy {
      display: block;
      margin: 15px auto 0;
      padding: 10px 24px;
      font-size: 1.1em;
      cursor: pointer;
      background-color: #2c3e50;
      color: #fff;
      border: none;
      border-radius: 2px;
      font-family: inherit;
    }
    .btn-copy:hover {
      background-color: #34495e;
    }
    .btn-copy:active {
      background-color: #1a252f;
    }
    /* å¹³æ¿ç›´å‘ */
    @media screen and (max-width: 768px) {
      .hexagrams-wrapper {
        flex-direction: column;
      }
      .hexagram {
        width: 100%;
        margin: 10px 0;
      }
    }

    /* å¤§æ‰‹æ©Ÿ */
    @media screen and (max-width: 600px) {
      body {
        margin: 15px;
        font-size: 14px;
      }

      /* æ™‚é–“è¼¸å…¥å€æ”¹ç‚ºå‚ç›´æ’åˆ— */
      .time-input {
        display: flex;
        flex-direction: column;
        gap: 15px;
        align-items: center;
      }
      .time-input > div {
        display: flex;
        align-items: center;
        gap: 5px;
      }
      .time-input select {
        width: 60px;
        font-size: 16px;
        padding: 5px;
      }
      .time-input span {
        font-size: 16px;
      }

      /* æ ¸å°é¸é …æ”¹ç‚ºå…©æ¬„ grid */
      .options {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 10px;
        text-align: left;
        padding: 0 10px;
        max-width: 400px;
        margin: 10px auto;
      }
      .options label {
        margin: 5px 0;
        font-size: 14px;
      }

      /* å¦è±¡å€å¡Šå…¨å¯¬é¡¯ç¤º */
      .hexagram {
        min-width: unset;
        width: 100%;
        padding: 15px;
        margin: 10px 0;
      }

      /* çˆ»ç·šè³‡è¨Šé‡æ–°æ’ç‰ˆç‚ºå¤šè¡Œå †ç–Š */
      .line, .support-line {
        flex-wrap: wrap;
        height: auto;
        min-height: 60px;
        padding: 8px 0;
        position: relative;
      }

      /* ç¬¬ä¸€è¡Œï¼šå…­ç¸ + çˆ»ä½ + å‹•çˆ»åœ“åœˆ + çˆ»ç·š */
      .beast-label {
        width: 50px;
        font-size: 14px;
        order: 1;
      }
      .line-label {
        width: 50px;
        font-size: 14px;
        order: 2;
      }
      .circle {
        order: 3;
        width: 40px;
        height: 40px;
        margin-right: 5px;
      }
      .line-shape {
        order: 4;
        margin-right: auto;
      }

      /* ç¬¬äºŒè¡Œï¼šå…­è¦ª + ä¸–æ‡‰ + ä¼ç¥ */
      .liuQin-container {
        order: 5;
        width: 100%;
        margin-left: 105px;
        margin-top: 5px;
        font-size: 13px;
      }
      .shiYing {
        font-size: 13px;
      }
      .fuShen {
        order: 6;
        width: 100%;
        margin-left: 105px;
        margin-top: 2px;
        font-size: 12px;
      }

      /* ç¬¬ä¸‰è¡Œï¼šåˆ¤å®šæ¨™ç±¤ */
      .empty-label, .month-empty-label, .chongjian-label {
        order: 7;
        width: 100%;
        margin-left: 105px;
        margin-top: 3px;
        font-size: 12px;
        display: inline-block;
      }

      /* å¢å¤§è§¸æ§ç›®æ¨™ */
      .yang-line {
        width: 70px;
        height: 12px;
      }
      .yin-line-container {
        width: 70px;
        height: 12px;
      }
      .yin-line-rect {
        width: 25px;
        height: 12px;
      }

      /* æ¨™é¡Œå­—é«”å„ªåŒ– */
      h1 {
        font-size: 22px;
        margin: 10px 0;
      }
      h2 {
        font-size: 18px;
        margin: 10px 0;
      }
      h3 {
        font-size: 16px;
        margin: 8px 0;
      }

      .hint {
        font-size: 13px;
        padding: 0 10px;
      }

      /* æ—¥æœŸé¸æ“‡å™¨åœ¨æ‰‹æ©Ÿä¸Šçš„å„ªåŒ– */
      .time-input input[type="date"] {
        width: 100%;
        max-width: 300px;
        font-size: 16px; /* é˜²æ­¢ iOS è‡ªå‹•ç¸®æ”¾ */
        padding: 10px;
      }

      .time-input label {
        display: block;
        margin-bottom: 5px;
      }

      .btn-save {
        font-size: 16px;
        padding: 12px 20px;
        margin: 15px auto;
      }

      .prompt-container {
        max-width: 100%;
        padding: 15px;
        margin: 15px 0;
      }

      .prompt-textarea {
        font-size: 13px;
        min-height: 180px;
        padding: 12px;
      }

      .btn-copy {
        font-size: 16px;
        padding: 12px 20px;
      }
    }

    /* å°æ‰‹æ©Ÿ */
    @media screen and (max-width: 480px) {
      body {
        margin: 10px;
        font-size: 13px;
      }

      .time-input select {
        width: 55px;
        font-size: 15px;
      }

      .hexagram {
        padding: 10px;
      }

      .line, .support-line {
        min-height: 55px;
      }

      .beast-label,
      .line-label {
        width: 45px;
        font-size: 13px;
      }

      .circle {
        width: 36px;
        height: 36px;
      }

      .liuQin-container,
      .fuShen {
        margin-left: 90px;
        font-size: 12px;
      }

      .empty-label,
      .month-empty-label,
      .chongjian-label {
        margin-left: 90px;
        font-size: 11px;
      }

      h1 {
        font-size: 20px;
      }
      h2 {
        font-size: 16px;
      }
      h3 {
        font-size: 15px;
      }

      .prompt-container {
        padding: 10px;
      }

      .prompt-textarea {
        font-size: 12px;
        min-height: 160px;
        padding: 10px;
      }

      .btn-copy {
        font-size: 15px;
        padding: 10px 18px;
      }
    }
  </style>
</head>
<body>
  <div id="app">
    <h1>æ˜“ç¶“å¦è±¡è¼¸å…¥</h1>
    <!-- æç¤ºè¨Šæ¯ -->
    <div class="hint">
      æç¤ºï¼šé»é¸å°åœ“åœˆå¯åˆ‡æ›å‹•çˆ»ç‹€æ…‹ï¼Œé»é¸çˆ»ç·šå¯åˆ‡æ›é™°é™½ç‹€æ…‹ã€‚
    </div>
    
    
    <div class="hint" v-if="lunarLibraryStatus === 'error'">
      Lunar library failed to load. Check CDN access or local ./lunar.min.js.
    </div>
<!-- æ—¥æœŸè¼¸å…¥èˆ‡è¨ˆç®—çµæœé¡¯ç¤ºå€ -->
    <div class="time-input">
      <h3>é¸æ“‡æ—¥æœŸ</h3>

      <!-- é™½æ›†æ—¥æœŸé¸æ“‡å™¨ -->
      <div style="margin: 15px 0;">
        <label style="font-weight: bold; margin-right: 10px;">é™½æ›†æ—¥æœŸï¼š</label>
        <input
          type="date"
          v-model="today.solarDateInput"
          @change="updateFromSolarDate"
          style="padding: 8px; font-size: 1em; border: 2px solid #555; border-radius: 4px; font-family: inherit;"
        >
      </div>

      <!-- è¨ˆç®—çµæœï¼šå¹²æ”¯é¡¯ç¤º -->
      <div class="kongwang" v-if="today.yearTian">
        <span style="font-weight: bold; color: #2c3e50;">
          å¹²æ”¯æ™‚è¾°ï¼š{{ today.yearTian }}{{ today.yearDi }}å¹´
          {{ today.monthTian }}{{ today.monthDi }}æœˆ
          {{ today.dayTian }}{{ today.dayDi }}æ—¥
        </span>
      </div>

      <!-- è¨ˆç®—çµæœï¼šè¾²æ›†æ—¥æœŸ -->
      <div class="kongwang" v-if="today.lunarYear">
        <span style="color: #2c3e50;">
          è¾²æ›†ï¼š{{ today.lunarYear }}å¹´
          {{ today.isLeapMonth ? 'é–' : '' }}{{ getLunarMonthName(today.lunarMonth) }}æœˆ
          {{ getLunarDayName(today.lunarDay) }}
        </span>
      </div>

      <!-- ç©ºäº¡é¡¯ç¤º -->
      <div class="kongwang" v-if="today.dayDi">
        <span v-if="today.monthDi && showMonthEmpty">æœˆç©ºäº¡ï¼š{{ monthKongWang }} </span>
        <span>æ—¥ç©ºäº¡ï¼š{{ dayKongWang }}</span>
      </div>

      <!-- æœˆä»¤è½‰åœŸæŒ‡ç¤º -->
      <div class="kongwang" v-if="today.isEarthPeriod" style="margin-top: 5px;">
        <span style="color: #b8860b; font-weight: bold;">
          âš ï¸ {{ today.earthPeriodInfo }}
        </span>
      </div>
    </div>
    
    <!-- æ ¸å°é¸é … -->
    <div class="options">
      <label>
        <input type="checkbox" v-model="showMonthGround" /> é¡¯ç¤ºæœˆåœ°æ”¯åˆ¤å®š
      </label>
      <label>
        <input type="checkbox" v-model="showDayGround" /> é¡¯ç¤ºæ—¥åœ°æ”¯åˆ¤å®š
      </label>
      <label>
        <input type="checkbox" v-model="showMonthFive" /> é¡¯ç¤ºæœˆäº”è¡Œåˆ¤å®š
      </label>
      <label>
        <input type="checkbox" v-model="showDayFive" /> é¡¯ç¤ºæ—¥äº”è¡Œåˆ¤å®š
      </label>
      <label>
        <input type="checkbox" v-model="showMonthEmpty" /> é¡¯ç¤ºæœˆç©ºäº¡åˆ¤å®š
      </label>
    </div>
    
    <!-- æŒ‰éˆ•ï¼šè½‰æˆåœ–ç‰‡ -->
    <button class="btn-save" @click="saveImage">è½‰æˆåœ–ç‰‡ä¸¦ä¸‹è¼‰</button>
    
    <div class="hexagrams-wrapper">
      <!-- æœ¬å¦å€å¡Š -->
      <div class="hexagram">
        <h2>æœ¬å¦ï¼š{{ currentHexagram.name }}</h2>
        <p>æœ¬å®®ï¼š{{ currentHexagram.benGong }}</p>
        <div class="lines-container">
          <div v-for="(line, index) in lines" :key="index" class="line">
            <!-- å…­ç¸æ¨™ç±¤ -->
            <span class="beast-label">{{ sixBeasts[index] }}</span>
            <span class="line-label">ç¬¬{{ index + 1 }}çˆ»</span>
            <div :class="['circle', line.isMoving ? 'active' : '']" @click.stop="toggleMoving(index)"></div>
            <div class="line-shape" @click="toggleLine(index)" :class="{ 'is-moving': line.isMoving }">
              <div v-if="line.isYang" class="yang-line"></div>
              <div v-else class="yin-line-container">
                <div class="yin-line-rect"></div>
                <div class="yin-line-rect"></div>
              </div>
              <div class="shiYing" v-if="currentHexagram.shiYing && currentHexagram.shiYing[index]">
                {{ currentHexagram.shiYing[index] }}
              </div>
            </div>
            <div class="liuQin-container" v-if="currentHexagram.liuQin && currentHexagram.liuQin[index]">
              {{ currentHexagram.liuQin[index] }}
            </div>
            <!-- ä¼ç¥é¡¯ç¤ºï¼šç§»åˆ°å…­è¦ªä¸‹æ–¹ -->
            <div class="fuShen" v-if="currentHexagram.fuShen && currentHexagram.fuShen[index]">
              ä¼ç¥ï¼š{{ currentHexagram.fuShen[index] }}
            </div>
            <!-- é¡¯ç¤ºæœˆç©ºåˆ¤å®šåœ¨æ—¥ç©ºåˆ¤å®šå·¦å´ -->
            <span class="month-empty-label" v-if="showMonthEmpty && getMonthEmptyDescription(index)">
              {{ getMonthEmptyDescription(index) }}
            </span>
            <!-- é¡¯ç¤ºæ—¥ç©ºåˆ¤å®š -->
            <span class="empty-label" v-if="getEmptyDescription(index)">
              {{ getEmptyDescription(index) }}
            </span>
            <!-- åˆ¤å®šæè¿° -->
            <span class="chongjian-label" v-if="getChongJian(index)">
              {{ getChongJian(index) }}
            </span>
          </div>
        </div>
      </div>
      <!-- Prompt æ–‡å­—æ¡†å€å¡Š -->
      <div class="prompt-container">
        <h2>AI å•ç­” Prompt</h2>
        <p style="font-size: 0.9em; color: #555; margin-bottom: 10px;">
          ä»¥ä¸‹æ˜¯æ ¹æ“šç•¶å‰å¦è±¡èˆ‡æ™‚è¾°è‡ªå‹•ç”Ÿæˆçš„è©³ç´°æè¿°ï¼Œæ‚¨å¯ä»¥ç›´æ¥è¤‡è£½è²¼ä¸Šè©¢å• AIï¼š
        </p>
        <textarea
          class="prompt-textarea"
          :value="hexagramPrompt"
          readonly
          @click="selectAllPrompt"
        ></textarea>
        <button class="btn-copy" @click="copyPrompt">ğŸ“‹ è¤‡è£½ Prompt</button>
      </div>
      <!-- æ”¯å¦å€å¡Š -->
      <div class="hexagram">
        <h2>æ”¯å¦ï¼š{{ supportHexagram.name }}</h2>
        <p>æœ¬å®®ï¼š{{ supportHexagram.benGong }}</p>
        <div class="lines-container">
          <div v-for="(line, index) in supportLines" :key="index" class="support-line">
            <div class="line-shape" :class="{ 'is-moving': line.isMoving }">
              <div v-if="line.isYang" class="yang-line"></div>
              <div v-else class="yin-line-container">
                <div class="yin-line-rect"></div>
                <div class="yin-line-rect"></div>
              </div>
            </div>
            <!-- å…­è¦ªé¡¯ç¤ºï¼ˆåªé¡¯ç¤ºæœ‰å‹•çˆ»çš„ï¼‰ -->
            <div class="liuQin-container" v-if="supportHexagramLiuQin[index]">
              {{ supportHexagramLiuQin[index] }}
            </div>
            <!-- æœˆç©ºåˆ¤å®š -->
            <span class="month-empty-label" v-if="showMonthEmpty && getSupportMonthEmptyDescription(index)">
              {{ getSupportMonthEmptyDescription(index) }}
            </span>
            <!-- æ—¥ç©ºåˆ¤å®š -->
            <span class="empty-label" v-if="getSupportEmptyDescription(index)">
              {{ getSupportEmptyDescription(index) }}
            </span>
            <!-- æ²–å»ºåˆ¤å®š -->
            <span class="chongjian-label" v-if="getSupportChongJian(index)">
              {{ getSupportChongJian(index) }}
            </span>
          </div>
        </div>
      </div>
    </div>
    <p>
      â€» æœ¬å¦ï¼šä¾æ“šç”¨æˆ¶è¨­å®šçš„å…­çˆ»ç‹€æ…‹ï¼Œç”±ä¸‹å¾€ä¸Šæ’åˆ—ã€‚<br>
      â€» æ”¯å¦ï¼šå°æ¯ä¸€çˆ»ï¼Œè‹¥ç‚ºå‹•å‰‡åè½‰å…¶ç‹€æ…‹ï¼ˆé¡¯ç¤ºç´…è‰²ï¼‰ï¼Œå¦å‰‡ä¿æŒåŸæ¨£ã€‚
    </p>
  </div>

  <script>
    new Vue({
      el: '#app',
      data: {
        lunarLibraryStatus: "loading",

        today: {
          // é™½æ›†æ—¥æœŸè¼¸å…¥
          solarDateInput: "",    // HTML5 date input ç¶å®šå€¼ (YYYY-MM-DD æ ¼å¼)

          yearTian: "",
          yearDi: "",
          monthTian: "",
          monthDi: "",
          dayTian: "",
          dayDi: "",

          // è¾²æ›†æ—¥æœŸæ¬„ä½
          lunarYear: 0,          // è¾²æ›†å¹´ä»½
          lunarMonth: 0,         // è¾²æ›†æœˆä»½ (1-12)
          lunarDay: 0,           // è¾²æ›†æ—¥æœŸ (1-30)
          isLeapMonth: false,    // æ˜¯å¦é–æœˆ
          lunarMonthDays: 0,     // æœ¬æœˆç¸½å¤©æ•¸ (29 æˆ– 30)

          // è½‰åœŸæœŸè¿½è¹¤
          isEarthPeriod: false,  // æ˜¯å¦è™•æ–¼è½‰åœŸæœŸ
          earthPeriodInfo: ""    // è½‰åœŸæœŸèªªæ˜æ–‡å­—
        },
        heavenlyStems: ["ç”²", "ä¹™", "ä¸™", "ä¸", "æˆŠ", "å·±", "åºš", "è¾›", "å£¬", "ç™¸"],
        earthlyBranches: ["å­", "ä¸‘", "å¯…", "å¯", "è¾°", "å·³", "åˆ", "æœª", "ç”³", "é…‰", "æˆŒ", "äº¥"],
        branchToElement: {
          "å­": "æ°´", "ä¸‘": "åœŸ", "å¯…": "æœ¨", "å¯": "æœ¨", "è¾°": "åœŸ",
          "å·³": "ç«", "åˆ": "ç«", "æœª": "åœŸ", "ç”³": "é‡‘", "é…‰": "é‡‘",
          "æˆŒ": "åœŸ", "äº¥": "æ°´"
        },
        // å¦å®®äº”è¡Œå°ç…§è¡¨
        gongToElement: {
          "ä¹¾å®®": "é‡‘",
          "å…Œå®®": "é‡‘",
          "é›¢å®®": "ç«",
          "éœ‡å®®": "æœ¨",
          "å·½å®®": "æœ¨",
          "åå®®": "æ°´",
          "è‰®å®®": "åœŸ",
          "å¤å®®": "åœŸ"
        },
        // æ—¥/æœˆç©ºäº¡å°æ‡‰è¡¨ï¼ˆåˆä½µå¾Œï¼‰
        dayKongWangMap: {
          "ç”²å­": "æˆŒäº¥",
          "ä¹™ä¸‘": "æˆŒäº¥",
          "ä¸™å¯…": "æˆŒäº¥",
          "ä¸å¯": "æˆŒäº¥",
          "æˆŠè¾°": "æˆŒäº¥",
          "å·±å·³": "æˆŒäº¥",
          "åºšåˆ": "æˆŒäº¥",
          "è¾›æœª": "æˆŒäº¥",
          "å£¬ç”³": "æˆŒäº¥",
          "ç™¸é…‰": "æˆŒäº¥",
          "ç”²æˆŒ": "ç”³é…‰",
          "ä¹™äº¥": "ç”³é…‰",
          "ä¸™å­": "ç”³é…‰",
          "ä¸ä¸‘": "ç”³é…‰",
          "æˆŠå¯…": "ç”³é…‰",
          "å·±å¯": "ç”³é…‰",
          "åºšè¾°": "ç”³é…‰",
          "è¾›å·³": "ç”³é…‰",
          "å£¬åˆ": "ç”³é…‰",
          "ç™¸æœª": "ç”³é…‰",
          "ç”²ç”³": "åˆæœª",
          "ä¹™é…‰": "åˆæœª",
          "ä¸™æˆŒ": "åˆæœª",
          "ä¸äº¥": "åˆæœª",
          "æˆŠå­": "åˆæœª",
          "å·±ä¸‘": "åˆæœª",
          "åºšå¯…": "åˆæœª",
          "è¾›å¯": "åˆæœª",
          "å£¬è¾°": "åˆæœª",
          "ç™¸å·³": "åˆæœª",
          "ç”²åˆ": "è¾°å·³",
          "ä¹™æœª": "è¾°å·³",
          "ä¸™ç”³": "è¾°å·³",
          "ä¸é…‰": "è¾°å·³",
          "æˆŠæˆŒ": "è¾°å·³",
          "å·±äº¥": "è¾°å·³",
          "åºšå­": "è¾°å·³",
          "è¾›ä¸‘": "è¾°å·³",
          "å£¬å¯…": "è¾°å·³",
          "ç™¸å¯": "è¾°å·³",
          "ç”²è¾°": "å¯…å¯",
          "ä¹™å·³": "å¯…å¯",
          "ä¸™åˆ": "å¯…å¯",
          "ä¸æœª": "å¯…å¯",
          "æˆŠç”³": "å¯…å¯",
          "å·±é…‰": "å¯…å¯",
          "åºšæˆŒ": "å¯…å¯",
          "è¾›äº¥": "å¯…å¯",
          "å£¬å­": "å¯…å¯",
          "ç™¸ä¸‘": "å¯…å¯",
          "ç”²å¯…": "å­ä¸‘",
          "ä¹™å¯": "å­ä¸‘",
          "ä¸™è¾°": "å­ä¸‘",
          "ä¸å·³": "å­ä¸‘",
          "æˆŠåˆ": "å­ä¸‘",
          "å·±æœª": "å­ä¸‘",
          "åºšç”³": "å­ä¸‘",
          "è¾›é…‰": "å­ä¸‘",
          "å£¬æˆŒ": "å­ä¸‘",
          "ç™¸äº¥": "å­ä¸‘"
        },
        lines: [
          { isYang: true, isMoving: false },
          { isYang: true, isMoving: false },
          { isYang: true, isMoving: false },
          { isYang: true, isMoving: false },
          { isYang: true, isMoving: false },
          { isYang: true, isMoving: false }
        ],
        hexagramMap: {
          "111111": { 
            name: "ä¹¾ç‚ºå¤©", 
            benGong: "ä¹¾å®®(æœ¬å®®)", 
            liuQin: ["å­æ°´å­å­«", "å¯…æœ¨å¦»è²¡", "è¾°åœŸçˆ¶æ¯", "åˆç«å®˜é¬¼", "ç”³é‡‘å…„å¼Ÿ", "æˆŒåœŸçˆ¶æ¯"],
            shiYing: ["", "", "æ‡‰", "", "", "ä¸–"],
            fuShen: ["", "", "", "", "", ""]
          },
          "110111": { 
            name: "å¤©æ¾¤å±¥", 
            benGong: "è‰®å®®(äº”ä¸–)", 
            liuQin: ["å·³ç«çˆ¶æ¯", "å¯æœ¨å®˜é¬¼", "ä¸‘åœŸå…„å¼Ÿ", "åˆç«çˆ¶æ¯", "ç”³é‡‘å­å­«", "æˆŒåœŸå…„å¼Ÿ"],
            shiYing: ["", "æ‡‰", "", "", "ä¸–", ""],
            fuShen: ["", "", "", "", "å­æ°´å¦»è²¡", ""]
          },
          "101111": { 
            name: "å¤©ç«åŒäºº", 
            benGong: "é›¢å®®(æ­¸é­‚)", 
            liuQin: ["å¯æœ¨çˆ¶æ¯", "ä¸‘åœŸå­å­«", "äº¥æ°´å®˜é¬¼", "åˆç«å…„å¼Ÿ", "ç”³é‡‘å¦»è²¡", "æˆŒåœŸå­å­«"],
            shiYing: ["", "", "ä¸–", "", "", "æ‡‰"],
            fuShen: ["", "", "", "", "", ""]
          },
          "100111": { 
            name: "å¤©é›·ç„¡å¦„", 
            benGong: "å·½å®®(å››ä¸–)", 
            liuQin: ["å­æ°´çˆ¶æ¯", "å¯…æœ¨å…„å¼Ÿ", "è¾°åœŸå¦»è²¡", "åˆç«å­å­«", "ç”³é‡‘å®˜é¬¼", "æˆŒåœŸå¦»è²¡"],
            shiYing: ["æ‡‰", "", "", "ä¸–", "", ""],
            fuShen: ["", "", "", "", "", ""]
          },
          "011111": { 
            name: "å¤©é¢¨å§¤", 
            benGong: "ä¹¾å®®(ä¸€ä¸–)", 
            liuQin: ["ä¸‘åœŸçˆ¶æ¯", "äº¥æ°´å­å­«", "é…‰é‡‘å…„å¼Ÿ", "åˆç«å®˜é¬¼", "ç”³é‡‘å…„å¼Ÿ", "æˆŒåœŸçˆ¶æ¯"],
            shiYing: ["ä¸–", "", "", "æ‡‰", "", ""],
            fuShen: ["", "å¯…æœ¨å¦»è²¡", "", "", "", ""]
          },
          "010111": { 
            name: "å¤©æ°´è¨Ÿ", 
            benGong: "é›¢å®®(éŠé­‚)", 
            liuQin: ["å¯…æœ¨çˆ¶æ¯", "è¾°åœŸå­å­«", "åˆç«å…„å¼Ÿ", "åˆç«å…„å¼Ÿ", "ç”³é‡‘å¦»è²¡", "æˆŒåœŸå­å­«"],
            shiYing: ["æ‡‰", "", "", "ä¸–", "", ""],
            fuShen: ["", "", "äº¥æ°´å®˜é¬¼", "", "", ""]
          },
          "001111": { 
            name: "å¤©å±±é¯", 
            benGong: "ä¹¾å®®(äºŒä¸–)", 
            liuQin: ["è¾°åœŸçˆ¶æ¯", "åˆç«å®˜é¬¼", "ç”³é‡‘å…„å¼Ÿ", "åˆç«å®˜é¬¼", "ç”³é‡‘å…„å¼Ÿ", "æˆŒåœŸçˆ¶æ¯"],
            shiYing: ["", "ä¸–", "", "", "æ‡‰", ""],
            fuShen: ["å­æ°´å­å­«", "å¯…æœ¨å¦»è²¡", "", "", "", ""]
          },
          "000111": { 
            name: "å¤©åœ°å¦", 
            benGong: "ä¹¾å®®(ä¸‰ä¸–)", 
            liuQin: ["æœªåœŸçˆ¶æ¯", "å·³ç«å®˜é¬¼", "å¯æœ¨å¦»è²¡", "åˆç«å®˜é¬¼", "ç”³é‡‘å…„å¼Ÿ", "æˆŒåœŸçˆ¶æ¯"],
            shiYing: ["", "", "ä¸–", "", "", "æ‡‰"],
            fuShen: ["å­æ°´å­å­«", "", "", "", "", ""]
          },
          "111110": { 
            name: "æ¾¤å¤©å¤¬", 
            benGong: "å¤å®®(äº”ä¸–)", 
            liuQin: ["å­æ°´å¦»è²¡", "å¯…æœ¨å®˜é¬¼", "è¾°åœŸå…„å¼Ÿ", "äº¥æ°´å¦»è²¡", "é…‰é‡‘å­å­«", "æœªåœŸå…„å¼Ÿ"],
            shiYing: ["", "æ‡‰", "", "", "ä¸–", ""],
            fuShen: ["", "å·³ç«çˆ¶æ¯", "", "", "", ""]
          },
          "110110": { 
            name: "å…Œç‚ºæ¾¤", 
            benGong: "å…Œå®®(æœ¬å®®)", 
            liuQin: ["å·³ç«å®˜é¬¼", "å¯æœ¨å¦»è²¡", "ä¸‘åœŸçˆ¶æ¯", "äº¥æ°´å­å­«", "é…‰é‡‘å…„å¼Ÿ", "æœªåœŸçˆ¶æ¯"],
            shiYing: ["", "", "æ‡‰", "", "", "ä¸–"],
            fuShen: ["", "", "", "", "", ""]
          },
          "101110": { 
            name: "æ¾¤ç«é©", 
            benGong: "åå®®(å››ä¸–)", 
            liuQin: ["å¯æœ¨å­å­«", "ä¸‘åœŸå®˜é¬¼", "äº¥æ°´å…„å¼Ÿ", "äº¥æ°´å…„å¼Ÿ", "é…‰é‡‘çˆ¶æ¯", "æœªåœŸå®˜é¬¼"],
            shiYing: ["æ‡‰", "", "", "ä¸–", "", ""],
            fuShen: ["", "", "åˆç«å¦»è²¡", "", "", ""]
          },
          "100110": { 
            name: "æ¾¤é›·éš¨", 
            benGong: "éœ‡å®®(æ­¸é­‚)", 
            liuQin: ["å­æ°´çˆ¶æ¯", "å¯…æœ¨å…„å¼Ÿ", "è¾°åœŸå¦»è²¡", "äº¥æ°´çˆ¶æ¯", "é…‰é‡‘å®˜é¬¼", "æœªåœŸå¦»è²¡"],
            shiYing: ["", "", "ä¸–", "", "", "æ‡‰"],
            fuShen: ["", "", "", "åˆç«å­å­«", "", ""]
          },
          "011110": { 
            name: "æ¾¤é¢¨å¤§é", 
            benGong: "éœ‡å®®(éŠé­‚)", 
            liuQin: ["ä¸‘åœŸå¦»è²¡", "äº¥æ°´çˆ¶æ¯", "é…‰é‡‘å®˜é¬¼", "äº¥æ°´çˆ¶æ¯", "é…‰é‡‘å®˜é¬¼", "æœªåœŸå¦»è²¡"],
            shiYing: ["æ‡‰", "", "", "ä¸–", "", ""],
            fuShen: ["", "å¯…æœ¨å…„å¼Ÿ", "", "åˆç«å­å­«", "", ""]
          },
          "010110": { 
            name: "æ¾¤æ°´å›°", 
            benGong: "å…Œå®®(ä¸€ä¸–)", 
            liuQin: ["å¯…æœ¨å¦»è²¡", "è¾°åœŸçˆ¶æ¯", "åˆç«å®˜é¬¼", "äº¥æ°´å­å­«", "é…‰é‡‘å…„å¼Ÿ", "æœªåœŸçˆ¶æ¯"],
            shiYing: ["ä¸–", "", "", "æ‡‰", "", ""],
            fuShen: ["", "", "", "", "", ""]
          },
          "001110": { 
            name: "æ¾¤å±±å’¸", 
            benGong: "å…Œå®®(ä¸‰ä¸–)", 
            liuQin: ["è¾°åœŸçˆ¶æ¯", "åˆç«å®˜é¬¼", "ç”³é‡‘å…„å¼Ÿ", "äº¥æ°´å­å­«", "é…‰é‡‘å…„å¼Ÿ", "æœªåœŸçˆ¶æ¯"],
            shiYing: ["", "", "ä¸–", "", "", "æ‡‰"],
            fuShen: ["", "å¯æœ¨å¦»è²¡", "", "", "", ""]
          },
          "000110": { 
            name: "æ¾¤åœ°èƒ", 
            benGong: "å…Œå®®(äºŒä¸–)", 
            liuQin: ["æœªåœŸçˆ¶æ¯", "å·³ç«å®˜é¬¼", "å¯æœ¨å¦»è²¡", "äº¥æ°´å­å­«", "é…‰é‡‘å…„å¼Ÿ", "æœªåœŸçˆ¶æ¯"],
            shiYing: ["", "ä¸–", "", "", "æ‡‰", ""],
            fuShen: ["", "", "", "", "", ""]
          },
          "111101": { 
            name: "ç«å¤©å¤§æœ‰", 
            benGong: "ä¹¾å®®(æ­¸é­‚)", 
            liuQin: ["å­æ°´å­å­«", "å¯…æœ¨å¦»è²¡", "è¾°åœŸçˆ¶æ¯", "é…‰é‡‘å…„å¼Ÿ", "æœªåœŸçˆ¶æ¯", "å·³ç«å®˜é¬¼"],
            shiYing: ["", "", "ä¸–", "", "", "æ‡‰"],
            fuShen: ["", "", "", "", "", ""]
          },
          "110101": { 
            name: "ç«æ¾¤ç½", 
            benGong: "è‰®å®®(å››ä¸–)", 
            liuQin: ["å·³ç«çˆ¶æ¯", "å¯æœ¨å®˜é¬¼", "ä¸‘åœŸå…„å¼Ÿ", "é…‰é‡‘å­å­«", "æœªåœŸå…„å¼Ÿ", "å·³ç«çˆ¶æ¯"],
            shiYing: ["æ‡‰", "", "", "ä¸–", "", ""],
            fuShen: ["", "", "", "", "å­æ°´å¦»è²¡", ""]
          },
          "101101": { 
            name: "é›¢ç‚ºç«", 
            benGong: "é›¢å®®(æœ¬å®®)", 
            liuQin: ["å¯æœ¨çˆ¶æ¯", "ä¸‘åœŸå­å­«", "äº¥æ°´å®˜é¬¼", "é…‰é‡‘å¦»è²¡", "æœªåœŸå­å­«", "å·³ç«å…„å¼Ÿ"],
            shiYing: ["", "", "æ‡‰", "", "", "ä¸–"],
            fuShen: ["", "", "", "", "", ""]
          },
          "100101": { 
            name: "ç«é›·å™¬å—‘", 
            benGong: "å·½å®®(äº”ä¸–)", 
            liuQin: ["å­æ°´çˆ¶æ¯", "å¯…æœ¨å…„å¼Ÿ", "è¾°åœŸå¦»è²¡", "é…‰é‡‘å®˜é¬¼", "æœªåœŸå¦»è²¡", "å·³ç«å­å­«"],
            shiYing: ["", "æ‡‰", "", "", "ä¸–", ""],
            fuShen: ["", "", "", "", "", ""]
          },
          "011101": { 
            name: "ç«é¢¨é¼", 
            benGong: "é›¢å®®(äºŒä¸–)", 
            liuQin: ["ä¸‘åœŸå­å­«", "äº¥æ°´å®˜é¬¼", "é…‰é‡‘å¦»è²¡", "é…‰é‡‘å¦»è²¡", "æœªåœŸå­å­«", "å·³ç«å…„å¼Ÿ"],
            shiYing: ["", "ä¸–", "", "", "æ‡‰", ""],
            fuShen: ["å¯æœ¨çˆ¶æ¯", "", "", "", "", ""]
          },
          "010101": { 
            name: "ç«æ°´æœªæ¿Ÿ", 
            benGong: "é›¢å®®(ä¸‰ä¸–)", 
            liuQin: ["å¯…æœ¨çˆ¶æ¯", "è¾°åœŸå­å­«", "åˆç«å…„å¼Ÿ", "é…‰é‡‘å¦»è²¡", "æœªåœŸå­å­«", "å·³ç«å…„å¼Ÿ"],
            shiYing: ["", "", "ä¸–", "", "", "æ‡‰"],
            fuShen: ["", "", "äº¥æ°´å®˜é¬¼", "", "", ""]
          },
          "001101": { 
            name: "ç«å±±æ—…", 
            benGong: "é›¢å®®(ä¸€ä¸–)", 
            liuQin: ["è¾°åœŸå­å­«", "åˆç«å…„å¼Ÿ", "ç”³é‡‘å¦»è²¡", "é…‰é‡‘å¦»è²¡", "æœªåœŸå­å­«", "å·³ç«å…„å¼Ÿ"],
            shiYing: ["ä¸–", "", "", "æ‡‰", "", ""],
            fuShen: ["å¯æœ¨çˆ¶æ¯", "", "äº¥æ°´å®˜é¬¼", "", "", ""]
          },
          "000101": { 
            name: "ç«åœ°æ™‰", 
            benGong: "ä¹¾å®®(éŠé­‚)", 
            liuQin: ["æœªåœŸçˆ¶æ¯", "å·³ç«å®˜é¬¼", "å¯æœ¨å¦»è²¡", "é…‰é‡‘å…„å¼Ÿ", "æœªåœŸçˆ¶æ¯", "å·³ç«å®˜é¬¼"],
            shiYing: ["", "", "æ‡‰", "", "", "ä¸–"],
            fuShen: ["å­æ°´å­å­«", "", "", "", "", ""]
          },
          "111100": { 
            name: "é›·å¤©å¤§å£¯", 
            benGong: "å¤å®®(å››ä¸–)", 
            liuQin: ["å­æ°´å¦»è²¡", "å¯…æœ¨å®˜é¬¼", "è¾°åœŸå…„å¼Ÿ", "åˆç«çˆ¶æ¯", "ç”³é‡‘å­å­«", "æˆŒåœŸå…„å¼Ÿ"],
            shiYing: ["æ‡‰", "", "", "ä¸–", "", ""],
            fuShen: ["", "", "", "", "", ""]
          },
          "110100": { 
            name: "é›·æ¾¤æ­¸å¦¹", 
            benGong: "å…Œå®®(æ­¸é­‚)", 
            liuQin: ["å·³ç«å®˜é¬¼", "å¯æœ¨å¦»è²¡", "ä¸‘åœŸçˆ¶æ¯", "åˆç«å®˜é¬¼", "ç”³é‡‘å…„å¼Ÿ", "æˆŒåœŸå…„å¼Ÿ"],
            shiYing: ["", "", "ä¸–", "", "", "æ‡‰"],
            fuShen: ["", "", "", "äº¥æ°´å­å­«", "", ""]
          },
          "101100": { 
            name: "é›·ç«è±", 
            benGong: "åå®®(äº”ä¸–)", 
            liuQin: ["å¯æœ¨å­å­«", "ä¸‘åœŸå®˜é¬¼", "äº¥æ°´å…„å¼Ÿ", "åˆç«å¦»è²¡", "ç”³é‡‘çˆ¶æ¯", "æˆŒåœŸå®˜é¬¼"],
            shiYing: ["", "ä¸–", "", "", "æ‡‰", ""],
            fuShen: ["", "", "", "", "", ""]
          },
          "100100": { 
            name: "éœ‡ç‚ºé›·", 
            benGong: "éœ‡å®®(æœ¬å®®)", 
            liuQin: ["å­æ°´çˆ¶æ¯", "å¯…æœ¨å…„å¼Ÿ", "è¾°åœŸå¦»è²¡", "åˆç«å­å­«", "ç”³é‡‘å®˜é¬¼", "æˆŒåœŸå¦»è²¡"],
            shiYing: ["", "", "æ‡‰", "", "", "ä¸–"],
            fuShen: ["", "", "", "", "", ""]
          },
          "011100": { 
            name: "é›·é¢¨æ†", 
            benGong: "éœ‡å®®(ä¸‰ä¸–)", 
            liuQin: ["ä¸‘åœŸå¦»è²¡", "äº¥æ°´çˆ¶æ¯", "é…‰é‡‘å®˜é¬¼", "åˆç«å­å­«", "ç”³é‡‘å®˜é¬¼", "æˆŒåœŸå¦»è²¡"],
            shiYing: ["", "ä¸–", "", "æ‡‰", "", ""],
            fuShen: ["å¯…æœ¨å¦»è²¡", "", "", "", "", ""]
          },
          "010100": { 
            name: "é›·æ°´è§£", 
            benGong: "éœ‡å®®(äºŒä¸–)", 
            liuQin: ["å¯…æœ¨å…„å¼Ÿ", "è¾°åœŸå¦»è²¡", "åˆç«å­å­«", "åˆç«å­å­«", "ç”³é‡‘å®˜é¬¼", "æˆŒåœŸå¦»è²¡"],
            shiYing: ["", "ä¸–", "", "", "æ‡‰", ""],
            fuShen: ["å­æ°´çˆ¶æ¯", "", "", "", "", ""]
          },
          "001100": { 
            name: "é›·å±±å°é", 
            benGong: "å…Œå®®(éŠé­‚)", 
            liuQin: ["è¾°åœŸçˆ¶æ¯", "åˆç«å®˜é¬¼", "ç”³é‡‘å…„å¼Ÿ", "åˆç«å®˜é¬¼", "ç”³é‡‘å…„å¼Ÿ", "æˆŒåœŸçˆ¶æ¯"],
            shiYing: ["å¯æœ¨å¦»è²¡", "äº¥æ°´å­å­«", "æ‡‰", "ä¸–", "", ""],
            fuShen: ["", "å¯æœ¨å¦»è²¡", "", "äº¥æ°´å­å­«", "", ""]
          },
          "000100": { 
            name: "é›·åœ°è±«", 
            benGong: "éœ‡å®®(ä¸€ä¸–)", 
            liuQin: ["æˆŒåœŸå¦»è²¡", "ç”³é‡‘å®˜é¬¼", "åˆç«å­å­«", "å¯æœ¨å…„å¼Ÿ", "å·³ç«å­å­«", "æœªåœŸå¦»è²¡"],
            shiYing: ["", "", "æ‡‰", "", "", "ä¸–"],
            fuShen: ["å­æ°´çˆ¶æ¯", "", "", "", "", ""]
          },
          "111011": { 
            name: "é¢¨å¤©å°ç•œ", 
            benGong: "å·½å®®(ä¸€ä¸–)", 
            liuQin: ["å¯æœ¨å…„å¼Ÿ", "å·³ç«å­å­«", "æœªåœŸå¦»è²¡", "è¾°åœŸå¦»è²¡", "å¯…æœ¨å…„å¼Ÿ", "å­æ°´çˆ¶æ¯"],
            shiYing: ["ä¸–", "", "", "æ‡‰", "", ""],
            fuShen: ["", "", "é…‰é‡‘å®˜é¬¼", "", "", ""]
          },
          "110011": { 
            name: "é¢¨æ¾¤ä¸­å­š", 
            benGong: "è‰®å®®(éŠé­‚)", 
            liuQin: ["å·³ç«çˆ¶æ¯", "å¯æœ¨å®˜é¬¼", "ä¸‘åœŸå…„å¼Ÿ", "æœªåœŸå…„å¼Ÿ", "å·³ç«çˆ¶æ¯", "å¯æœ¨å®˜é¬¼"],
            shiYing: ["æ‡‰", "", "", "ä¸–", "", ""],
            fuShen: ["", "", "ç”³é‡‘å­å­«", "", "å­æ°´å¦»è²¡", ""]
          },
          "101011": { 
            name: "é¢¨ç«å®¶äºº", 
            benGong: "å·½å®®(äºŒä¸–)", 
            liuQin: ["å¯æœ¨å…„å¼Ÿ", "ä¸‘åœŸå¦»è²¡", "äº¥æ°´çˆ¶æ¯", "æœªåœŸå¦»è²¡", "å·³ç«å­å­«", "å¯æœ¨å…„å¼Ÿ"],
            shiYing: ["", "ä¸–", "", "", "æ‡‰", ""],
            fuShen: ["", "", "é…‰é‡‘å®˜é¬¼", "", "", ""]
          },
          "100011": { 
            name: "é¢¨é›·ç›Š", 
            benGong: "å·½å®®(ä¸‰ä¸–)", 
            liuQin: ["å¯æœ¨å…„å¼Ÿ", "å·³ç«å­å­«", "æœªåœŸå¦»è²¡", "è¾°åœŸå¦»è²¡", "å¯…æœ¨å…„å¼Ÿ", "å­æ°´çˆ¶æ¯"],
            shiYing: ["", "", "ä¸–", "", "", "æ‡‰"],
            fuShen: ["", "", "é…‰é‡‘å®˜é¬¼", "", "", ""]
          },
          "011011": { 
            name: "å·½ç‚ºé¢¨", 
            benGong: "å·½å®®(æœ¬å®®)", 
            liuQin: ["ä¸‘åœŸå¦»è²¡", "äº¥æ°´çˆ¶æ¯", "é…‰é‡‘å®˜é¬¼", "æœªåœŸå¦»è²¡", "å·³ç«å­å­«", "å¯æœ¨å…„å¼Ÿ"],
            shiYing: ["", "", "æ‡‰", "", "", "ä¸–"],
            fuShen: ["", "", "", "", "", ""]
          },
          "010011": { 
            name: "é¢¨æ°´æ¸™", 
            benGong: "é›¢å®®(äº”ä¸–)", 
            liuQin: ["å¯…æœ¨çˆ¶æ¯", "è¾°åœŸå­å­«", "åˆç«å…„å¼Ÿ", "æœªåœŸå­å­«", "å·³ç«å…„å¼Ÿ", "å¯æœ¨çˆ¶æ¯"],
            shiYing: ["", "æ‡‰", "", "", "ä¸–", ""],
            fuShen: ["", "", "äº¥æ°´å®˜é¬¼", "é…‰é‡‘å¦»è²¡", "", ""]
          },
          "001011": { 
            name: "é¢¨å±±æ¼¸", 
            benGong: "è‰®å®®(æ­¸é­‚)", 
            liuQin: ["è¾°åœŸå…„å¼Ÿ", "åˆç«çˆ¶æ¯", "ç”³é‡‘å­å­«", "æœªåœŸå…„å¼Ÿ", "å·³ç«çˆ¶æ¯", "å¯æœ¨å®˜é¬¼"],
            shiYing: ["", "", "ä¸–", "", "", "æ‡‰"],
            fuShen: ["", "", "", "", "å­æ°´å¦»è²¡", ""]
          },
          "000011": { 
            name: "é¢¨åœ°è§€", 
            benGong: "ä¹¾å®®(å››ä¸–)", 
            liuQin: ["æœªåœŸçˆ¶æ¯", "å·³ç«å®˜é¬¼", "å¯æœ¨å¦»è²¡", "æœªåœŸçˆ¶æ¯", "å·³ç«å®˜é¬¼", "å¯æœ¨å¦»è²¡"],
            shiYing: ["æ‡‰", "", "", "ä¸–", "", ""],
            fuShen: ["å­æ°´å­å­«", "", "", "", "ç”³é‡‘å…„å¼Ÿ", ""]
          },
          "111010": { 
            name: "æ°´å¤©éœ€", 
            benGong: "å¤å®®(éŠé­‚)", 
            liuQin: ["å­æ°´å¦»è²¡", "å¯…æœ¨å®˜é¬¼", "è¾°åœŸå…„å¼Ÿ", "ç”³é‡‘å­å­«", "æˆŒåœŸå…„å¼Ÿ", "å­æ°´å¦»è²¡"],
            shiYing: ["æ‡‰", "", "", "ä¸–", "", ""],
            fuShen: ["", "", "", "", "", ""]
          },
          "110010": { 
            name: "æ°´æ¾¤ç¯€", 
            benGong: "åå®®(ä¸€ä¸–)", 
            liuQin: ["å·³ç«å¦»è²¡", "å¯æœ¨å­å­«", "ä¸‘åœŸå®˜é¬¼", "ç”³é‡‘çˆ¶æ¯", "æˆŒåœŸå®˜é¬¼", "å­æ°´å…„å¼Ÿ"],
            shiYing: ["ä¸–", "", "", "æ‡‰", "", ""],
            fuShen: ["", "", "", "", "", ""]
          },
          "101010": { 
            name: "æ°´ç«æ—¢æ¿Ÿ", 
            benGong: "åå®®(ä¸‰ä¸–)", 
            liuQin: ["å¯æœ¨å­å­«", "ä¸‘åœŸå®˜é¬¼", "äº¥æ°´å…„å¼Ÿ", "ç”³é‡‘çˆ¶æ¯", "æˆŒåœŸå®˜é¬¼", "å­æ°´å…„å¼Ÿ"],
            shiYing: ["", "", "ä¸–", "", "", "æ‡‰"],
            fuShen: ["", "", "åˆç«å¦»è²¡", "", "", ""]
          },
          "100010": { 
            name: "æ°´é›·å±¯", 
            benGong: "åå®®(äºŒä¸–)", 
            liuQin: ["å­æ°´å…„å¼Ÿ", "å¯…æœ¨å­å­«", "è¾°åœŸå®˜é¬¼", "ç”³é‡‘çˆ¶æ¯", "æˆŒåœŸå®˜é¬¼", "å­æ°´å…„å¼Ÿ"],
            shiYing: ["", "ä¸–", "", "", "æ‡‰", ""],
            fuShen: ["", "", "åˆç«å¦»è²¡", "", "", ""]
          },
          "011010": { 
            name: "æ°´é¢¨äº•", 
            benGong: "éœ‡å®®(äº”ä¸–)", 
            liuQin: ["ä¸‘åœŸå¦»è²¡", "äº¥æ°´çˆ¶æ¯", "é…‰é‡‘å®˜é¬¼", "ç”³é‡‘å®˜é¬¼", "æˆŒåœŸå¦»è²¡", "å­æ°´çˆ¶æ¯"],
            shiYing: ["", "æ‡‰", "", "", "ä¸–", ""],
            fuShen: ["", "å¯…æœ¨å…„å¼Ÿ", "", "åˆç«å­å­«", "", ""]
          },
          "010010": { 
            name: "åç‚ºæ°´", 
            benGong: "åå®®(æœ¬å®®)", 
            liuQin: ["å¯…æœ¨å­å­«", "è¾°åœŸå®˜é¬¼", "åˆç«å¦»è²¡", "ç”³é‡‘çˆ¶æ¯", "æˆŒåœŸå®˜é¬¼", "å­æ°´å…„å¼Ÿ"],
            shiYing: ["", "", "æ‡‰", "", "", "ä¸–"],
            fuShen: ["", "", "", "", "", ""]
          },
          "001010": { 
            name: "æ°´å±±è¹‡", 
            benGong: "å…Œå®®(å››ä¸–)", 
            liuQin: ["è¾°åœŸçˆ¶æ¯", "åˆç«å®˜é¬¼", "ç”³é‡‘å…„å¼Ÿ", "ç”³é‡‘å…„å¼Ÿ", "æˆŒåœŸå®˜é¬¼", "å­æ°´å­å­«"],
            shiYing: ["æ‡‰", "", "", "ä¸–", "", ""],
            fuShen: ["", "å¯æœ¨å¦»è²¡", "", "", "", ""]
          },
          "000010": { 
            name: "æ°´åœ°æ¯”", 
            benGong: "å¤å®®(æ­¸é­‚)", 
            liuQin: ["æœªåœŸå…„å¼Ÿ", "å·³ç«çˆ¶æ¯", "å¯æœ¨å®˜é¬¼", "ç”³é‡‘å­å­«", "æˆŒåœŸå…„å¼Ÿ", "å­æ°´å¦»è²¡"],
            shiYing: ["", "", "ä¸–", "", "", "æ‡‰"],
            fuShen: ["", "", "", "", "", ""]
          },
          "111001": { 
            name: "å±±å¤©å¤§ç•œ", 
            benGong: "è‰®å®®(äºŒä¸–)", 
            liuQin: ["å­æ°´å¦»è²¡", "å¯…æœ¨å®˜é¬¼", "è¾°åœŸå…„å¼Ÿ", "æˆŒåœŸå…„å¼Ÿ", "å­æ°´å¦»è²¡", "å¯…æœ¨å®˜é¬¼"],
            shiYing: ["", "ä¸–", "", "", "æ‡‰", ""],
            fuShen: ["", "åˆç«çˆ¶æ¯", "ç”³é‡‘å­å­«", "", "", ""]
          },
          "110001": { 
            name: "å±±æ¾¤æ", 
            benGong: "è‰®å®®(ä¸‰ä¸–)", 
            liuQin: ["å·³ç«çˆ¶æ¯", "å¯æœ¨å®˜é¬¼", "ä¸‘åœŸå…„å¼Ÿ", "æˆŒåœŸå…„å¼Ÿ", "å­æ°´å¦»è²¡", "å¯…æœ¨å®˜é¬¼"],
            shiYing: ["", "", "ä¸–", "", "", "æ‡‰"],
            fuShen: ["", "", "ç”³é‡‘å­å­«", "", "", ""]
          },
          "101001": { 
            name: "å±±ç«è³", 
            benGong: "è‰®å®®(ä¸€ä¸–)", 
            liuQin: ["å¯æœ¨å®˜é¬¼", "ä¸‘åœŸå…„å¼Ÿ", "äº¥æ°´å¦»è²¡", "æˆŒåœŸå…„å¼Ÿ", "å­æ°´å¦»è²¡", "å¯…æœ¨å®˜é¬¼"],
            shiYing: ["ä¸–", "", "", "æ‡‰", "", ""],
            fuShen: ["", "åˆç«çˆ¶æ¯", "ç”³é‡‘å­å­«", "", "", ""]
          },
          "100001": { 
            name: "å±±é›·é ¤", 
            benGong: "å·½å®®(éŠé­‚)", 
            liuQin: ["å­æ°´çˆ¶æ¯", "å¯…æœ¨å…„å¼Ÿ", "è¾°åœŸå¦»è²¡", "æˆŒåœŸå¦»è²¡", "å­æ°´çˆ¶æ¯", "å¯…æœ¨å…„å¼Ÿ"],
            shiYing: ["æ‡‰", "", "", "ä¸–", "", ""],
            fuShen: ["", "", "é…‰é‡‘å®˜é¬¼", "", "å·³ç«å­å­«", ""]
          },
          "011001": { 
            name: "å±±é¢¨è ±", 
            benGong: "å·½å®®(æ­¸é­‚)", 
            liuQin: ["ä¸‘åœŸå¦»è²¡", "äº¥æ°´çˆ¶æ¯", "é…‰é‡‘å®˜é¬¼", "æˆŒåœŸå¦»è²¡", "å­æ°´çˆ¶æ¯", "å¯…æœ¨å…„å¼Ÿ"],
            shiYing: ["", "", "ä¸–", "", "", "æ‡‰"],
            fuShen: ["", "", "", "", "å·³ç«å­å­«", ""]
          },
          "010001": { 
            name: "å±±æ°´è’™", 
            benGong: "é›¢å®®(å››ä¸–)", 
            liuQin: ["å¯…æœ¨çˆ¶æ¯", "è¾°åœŸå­å­«", "åˆç«å…„å¼Ÿ", "æˆŒåœŸå­å­«", "å­æ°´å®˜é¬¼", "å¯…æœ¨çˆ¶æ¯"],
            shiYing: ["æ‡‰", "", "", "ä¸–", "", ""],
            fuShen: ["", "", "", "é…‰é‡‘å¦»è²¡", "", ""]
          },
          "001001": { 
            name: "è‰®ç‚ºå±±", 
            benGong: "è‰®å®®(æœ¬å®®)", 
            liuQin: ["è¾°åœŸå…„å¼Ÿ", "åˆç«çˆ¶æ¯", "ç”³é‡‘å­å­«", "æˆŒåœŸå…„å¼Ÿ", "å­æ°´å¦»è²¡", "å¯…æœ¨å®˜é¬¼"],
            shiYing: ["", "", "æ‡‰", "", "", "ä¸–"],
            fuShen: ["", "", "", "", "", ""]
          },
          "000001": { 
            name: "å±±åœ°å‰", 
            benGong: "ä¹¾å®®(äº”ä¸–)", 
            liuQin: ["æœªåœŸçˆ¶æ¯", "å·³ç«å®˜é¬¼", "å¯æœ¨å¦»è²¡", "æˆŒåœŸçˆ¶æ¯", "å­æ°´å­å­«", "å¯…æœ¨å¦»è²¡"],
            shiYing: ["", "æ‡‰", "", "", "ä¸–", ""],
            fuShen: ["", "", "", "", "ç”³é‡‘å…„å¼Ÿ", ""]
          },
          "111000": { 
            name: "åœ°å¤©æ³°", 
            benGong: "å¤å®®(ä¸‰ä¸–)", 
            liuQin: ["å­æ°´å¦»è²¡", "å¯…æœ¨å®˜é¬¼", "æˆŒåœŸå…„å¼Ÿ", "ä¸‘åœŸå…„å¼Ÿ", "äº¥æ°´å¦»è²¡", "é…‰é‡‘å­å­«"],
            shiYing: ["", "", "ä¸–", "", "", "æ‡‰"],
            fuShen: ["", "å·³ç«çˆ¶æ¯", "", "", "", ""]
          },
          "110000": { 
            name: "åœ°æ¾¤è‡¨", 
            benGong: "å¤å®®(äºŒä¸–)", 
            liuQin: ["å·³ç«çˆ¶æ¯", "å¯æœ¨å®˜é¬¼", "ä¸‘åœŸå…„å¼Ÿ", "ä¸‘åœŸå…„å¼Ÿ", "äº¥æ°´å¦»è²¡", "é…‰é‡‘å­å­«"],
            shiYing: ["", "ä¸–", "", "", "æ‡‰", ""],
            fuShen: ["", "", "", "", "", ""]
          },
          "101000": { 
            name: "åœ°ç«æ˜å¤·", 
            benGong: "åå®®(éŠé­‚)", 
            liuQin: ["å¯æœ¨å­å­«", "ä¸‘åœŸå®˜é¬¼", "äº¥æ°´å…„å¼Ÿ", "ä¸‘åœŸå®˜é¬¼", "äº¥æ°´å…„å¼Ÿ", "é…‰é‡‘çˆ¶æ¯"],
            shiYing: ["æ‡‰", "", "", "ä¸–", "", ""],
            fuShen: ["", "", "åˆç«å¦»è²¡", "", "", ""]
          },
          "100000": { 
            name: "åœ°é›·å¾©", 
            benGong: "å¤å®®(ä¸€ä¸–)", 
            liuQin: ["å­æ°´å¦»è²¡", "å¯…æœ¨å®˜é¬¼", "è¾°åœŸå…„å¼Ÿ", "ä¸‘åœŸå…„å¼Ÿ", "äº¥æ°´å¦»è²¡", "é…‰é‡‘å­å­«"],
            shiYing: ["ä¸–", "", "", "æ‡‰", "", ""],
            fuShen: ["", "å·³ç«çˆ¶æ¯", "", "", "", ""]
          },
          "011000": { 
            name: "åœ°é¢¨å‡", 
            benGong: "éœ‡å®®(å››ä¸–)", 
            liuQin: ["ä¸‘åœŸå¦»è²¡", "äº¥æ°´çˆ¶æ¯", "é…‰é‡‘å®˜é¬¼", "ä¸‘åœŸå¦»è²¡", "äº¥æ°´çˆ¶æ¯", "é…‰é‡‘å®˜é¬¼"],
            shiYing: ["æ‡‰", "", "", "ä¸–", "", ""],
            fuShen: ["", "å¯…æœ¨å…„å¼Ÿ", "", "åˆç«å­å­«", "", ""]
          },
          "010000": { 
            name: "åœ°æ°´å¸«", 
            benGong: "åå®®(æ­¸é­‚)", 
            liuQin: ["å¯…æœ¨å­å­«", "è¾°åœŸå®˜é¬¼", "åˆç«å¦»è²¡", "ä¸‘åœŸå®˜é¬¼", "äº¥æ°´å…„å¼Ÿ", "é…‰é‡‘çˆ¶æ¯"],
            shiYing: ["", "", "ä¸–", "", "", "æ‡‰"],
            fuShen: ["", "", "", "", "", ""]
          },
          "001000": { 
            name: "åœ°å±±è¬™", 
            benGong: "å…Œå®®(äº”ä¸–)", 
            liuQin: ["è¾°åœŸçˆ¶æ¯", "åˆç«å®˜é¬¼", "ç”³é‡‘å…„å¼Ÿ", "ä¸‘åœŸçˆ¶æ¯", "äº¥æ°´å­å­«", "é…‰é‡‘å…„å¼Ÿ"],
            shiYing: ["", "æ‡‰", "", "", "ä¸–", ""],
            fuShen: ["", "å¯æœ¨å¦»è²¡", "", "", "", ""]
          },
          "000000": { 
            name: "å¤ç‚ºåœ°", 
            benGong: "å¤å®®(æœ¬å®®)", 
            liuQin: ["æœªåœŸå…„å¼Ÿ", "å·³ç«çˆ¶æ¯", "å¯æœ¨å®˜é¬¼", "ä¸‘åœŸå…„å¼Ÿ", "äº¥æ°´å¦»è²¡", "é…‰é‡‘å­å­«"],
            shiYing: ["", "", "æ‡‰", "", "", "ä¸–"],
            fuShen: ["", "", "", "", "", ""]
          }
        },
        // æ ¸å°é¸é …é è¨­
        showMonthGround: true,
        showDayGround: true,
        showMonthFive: true,
        showDayFive: true,
        showMonthEmpty: true
      },
      computed: {
        currentPattern() {
          return this.lines.map(line => line.isYang ? "1" : "0").join('');
        },
        currentHexagram() {
          return this.hexagramMap[this.currentPattern] || { 
            name: "æœªçŸ¥å¦è±¡", 
            benGong: "æœªçŸ¥", 
            liuQin: ["", "", "", "", "", ""],
            shiYing: ["", "", "", "", "", ""],
            fuShen: ["", "", "", "", "", ""]
          };
        },
        supportLines() {
          return this.lines.map(line => ({
            isYang: line.isMoving ? !line.isYang : line.isYang,
            isMoving: line.isMoving
          }));
        },
        supportPattern() {
          return this.supportLines.map(line => line.isYang ? "1" : "0").join('');
        },
        supportHexagram() {
          return this.hexagramMap[this.supportPattern] || { 
            name: "æœªçŸ¥å¦è±¡", 
            benGong: "æœªçŸ¥" 
          };
        },
        dayKongWang() {
          const gz = this.today.dayTian + this.today.dayDi;
          return this.dayKongWangMap[gz] || "";
        },
        monthKongWang() {
          const gz = this.today.monthTian + this.today.monthDi;
          return this.dayKongWangMap[gz] || "";
        },
        sixBeasts() {
          let stem = this.today.dayTian;
          if (!stem) return ["", "", "", "", "", ""];
          if (stem === "ç”²" || stem === "ä¹™") {
            return ["é’é¾", "æœ±é›€", "å‹¾é™³", "é¨°è›‡", "ç™½è™", "ç„æ­¦"];
          } else if (stem === "ä¸™" || stem === "ä¸") {
            return ["æœ±é›€", "å‹¾é™³", "é¨°è›‡", "ç™½è™", "ç„æ­¦", "é’é¾"];
          } else if (stem === "æˆŠ") {
            return ["å‹¾é™³", "é¨°è›‡", "ç™½è™", "ç„æ­¦", "é’é¾", "æœ±é›€"];
          } else if (stem === "å·±") {
            return ["é¨°è›‡", "ç™½è™", "ç„æ­¦", "é’é¾", "æœ±é›€", "å‹¾é™³"];
          } else if (stem === "åºš" || stem === "è¾›") {
            return ["ç™½è™", "ç„æ­¦", "é’é¾", "æœ±é›€", "å‹¾é™³", "é¨°è›‡"];
          } else if (stem === "å£¬" || stem === "ç™¸") {
            return ["ç„æ­¦", "é’é¾", "æœ±é›€", "å‹¾é™³", "é¨°è›‡", "ç™½è™"];
          } else {
            return ["", "", "", "", "", ""];
          }
        },
        hexagramPrompt() {
          let prompt = "";

          // å¦è±¡è³‡è¨Šï¼šæœ¬å¦åŒ–æ”¯å¦
          prompt += `å¦ï¼š${this.currentHexagram.name}ï¼ˆ${this.currentHexagram.benGong}ï¼‰`;
          if (this.supportHexagram.name !== this.currentHexagram.name) {
            prompt += `åŒ–æˆ ${this.supportHexagram.name}ï¼ˆ${this.supportHexagram.benGong}ï¼‰`;
          }
          prompt += `\n`;

          // ç•¶å‰æ™‚è¾°
          let yearStr = this.today.yearTian + this.today.yearDi;
          let monthStr = this.today.monthTian + this.today.monthDi;
          let dayStr = this.today.dayTian + this.today.dayDi;
          prompt += `ç•¶å‰æ™‚è¾°ï¼š${yearStr}å¹´ ${monthStr}æœˆ ${dayStr}æ—¥\n`;

          // è¾²æ›†æ—¥æœŸä¿¡æ¯
          if (this.today.lunarYear) {
            const leapText = this.today.isLeapMonth ? 'é–' : '';
            const monthName = this.getLunarMonthName(this.today.lunarMonth);
            const dayName = this.getLunarDayName(this.today.lunarDay);
            prompt += `è¾²æ›†æ—¥æœŸï¼š${this.today.lunarYear}å¹´${leapText}${monthName}æœˆ${dayName}\n`;
          }

          // è½‰åœŸæœŸç‹€æ…‹
          if (this.today.isEarthPeriod) {
            prompt += `æœˆä»¤ç‹€æ…‹ï¼š${this.today.earthPeriodInfo}ï¼ˆæœˆäº”è¡Œè½‰ç‚ºåœŸï¼‰\n`;
          }

          // ç©ºäº¡è³‡è¨Š
          if (this.dayKongWang || this.monthKongWang) {
            prompt += `ç©ºäº¡ï¼š`;
            if (this.dayKongWang) prompt += `æ—¥ç©ºäº¡${this.dayKongWang}`;
            if (this.monthKongWang && this.dayKongWang) prompt += `  `;
            if (this.monthKongWang) prompt += `æœˆç©ºäº¡${this.monthKongWang}`;
            prompt += `\n`;
          }

          prompt += `\n`;

          // å…­çˆ»è©³ç´°è³‡è¨Š
          for (let i = 0; i < 6; i++) {
            let line = this.lines[i];
            let lineNum = i + 1;

            // çˆ»ä½èˆ‡é™°é™½
            if (line.isMoving) {
              // å‹•çˆ»ï¼šé¡¯ç¤ºè®ŠåŒ–
              let fromYinYang = line.isYang ? "é™½çˆ»" : "é™°çˆ»";
              let toYinYang = this.supportLines[i].isYang ? "é™½çˆ»" : "é™°çˆ»";
              prompt += `ç¬¬${lineNum}çˆ»ï¼š${fromYinYang}è®Š${toYinYang}`;
            } else {
              // éœçˆ»
              let yinYang = line.isYang ? "é™½çˆ»" : "é™°çˆ»";
              prompt += `ç¬¬${lineNum}çˆ»ï¼š${yinYang}éœæ­¢`;
            }

            // å…­ç¸
            if (this.sixBeasts[i]) {
              prompt += `ï¼Œ${this.sixBeasts[i]}`;
            }

            // å…­è¦ª
            if (this.currentHexagram.liuQin && this.currentHexagram.liuQin[i]) {
              prompt += `æŒ${this.currentHexagram.liuQin[i]}`;

              // å¦‚æœæ˜¯å‹•çˆ»ï¼ŒåŠ å…¥ã€ŒåŒ–ã€æ”¯å¦å…­è¦ª
              if (line.isMoving && this.supportHexagramLiuQin[i]) {
                prompt += `åŒ–${this.supportHexagramLiuQin[i]}`;
              }
            }

            // ä¸–æ‡‰
            if (this.currentHexagram.shiYing && this.currentHexagram.shiYing[i]) {
              prompt += `ï¼ˆ${this.currentHexagram.shiYing[i]}ä½ï¼‰`;
            }

            // ä¼ç¥
            if (this.currentHexagram.fuShen && this.currentHexagram.fuShen[i]) {
              prompt += `ï¼Œä¼ç¥${this.currentHexagram.fuShen[i]}`;
            }

            // æ™‚è¾°åˆ¤å®š
            let judgments = [];

            // æœˆç©º
            let monthEmpty = this.getMonthEmptyDescription(i);
            if (monthEmpty) judgments.push(monthEmpty);

            // æ—¥ç©º
            let dayEmpty = this.getEmptyDescription(i);
            if (dayEmpty) judgments.push(dayEmpty);

            // æ²–å»ºèˆ‡äº”è¡Œ
            let chongJian = this.getChongJian(i);
            if (chongJian) {
              judgments.push(chongJian);
            }

            if (judgments.length > 0) {
              prompt += `ï¼Œå—${judgments.join("ã€")}å½±éŸ¿`;
            }

            prompt += `\n`;
          }

          return prompt;
        },
        supportHexagramLiuQin() {
          // ç‚ºæ”¯å¦è¨ˆç®—å…­è¦ªï¼ˆåªç‚ºæœ‰å‹•çˆ»çš„çˆ»ä½è¨ˆç®—ï¼‰
          let result = [];

          // å–å¾—æœ¬å¦å¦å®®åç¨±ä¸¦è§£æå‡ºç´”å¦å®®å
          let benGong = this.currentHexagram.benGong || "";
          // å¾ "ä¹¾å®®(æœ¬å®®)" æˆ– "é›¢å®®(æ­¸é­‚)" ä¸­æå–å¦å®®åç¨±ï¼šå„ªå…ˆå–æ‹¬å¼§å‰çš„å¦å®®ï¼Œè‹¥ç„¡å†å–æ‹¬å¼§å…§ï¼Œå†é€€å›ç¬¬ä¸€å€‹å«ã€Œå®®ã€çš„ç‰‡æ®µ
          let gongMatch =
            benGong.match(/^\s*([^ï¼ˆ()]+?å®®)/) ||
            benGong.match(/[ï¼ˆ(]([^ï¼ˆï¼‰()]+?å®®)[ï¼‰)]/) ||
            benGong.match(/([^ï¼ˆï¼‰()]+?å®®)/);
          if (!gongMatch || !gongMatch[1]) {
            return ["", "", "", "", "", ""];
          }
          let gongName = gongMatch[1];

          // å–å¾—å¦å®®äº”è¡Œ
          let gongElement = this.gongToElement[gongName];
          if (!gongElement) {
            return ["", "", "", "", "", ""];
          }

          // ç‚ºæ¯ä¸€çˆ»è¨ˆç®—å…­è¦ª
          for (let i = 0; i < 6; i++) {
            // åªç‚ºå‹•çˆ»è¨ˆç®—
            if (!this.lines[i].isMoving) {
              result.push("");
              continue;
            }

            // å¾æ”¯å¦çš„å…­è¦ªè³‡æ–™ä¸­å–å¾—åœ°æ”¯
            let supportLiuQin = this.supportHexagram.liuQin && this.supportHexagram.liuQin[i];
            if (!supportLiuQin) {
              result.push("");
              continue;
            }

            // æå–åœ°æ”¯ï¼ˆç¬¬ä¸€å€‹å­—ï¼‰
            let branch = supportLiuQin.charAt(0);

            // å–å¾—åœ°æ”¯å°æ‡‰çš„äº”è¡Œ
            let lineElement = this.branchToElement[branch];
            if (!lineElement) {
              result.push("");
              continue;
            }

            // è¨ˆç®—å…­è¦ªé—œä¿‚
            let relation = this.getLiuQinRelation(gongElement, lineElement);

            // çµ„åˆå®Œæ•´å­—ä¸²ï¼šåœ°æ”¯ + äº”è¡Œ + å…­è¦ª
            result.push(branch + lineElement + relation);
          }

          return result;
        }
      },
      methods: {
        toggleLine(index) {
          this.lines[index].isYang = !this.lines[index].isYang;
        },
        toggleMoving(index) {
          this.lines[index].isMoving = !this.lines[index].isMoving;
        },
        getOpposite(branch) {
          const opposites = {
            "å­": "åˆ", "åˆ": "å­",
            "ä¸‘": "æœª", "æœª": "ä¸‘",
            "å¯…": "ç”³", "ç”³": "å¯…",
            "å¯": "é…‰", "é…‰": "å¯",
            "è¾°": "æˆŒ", "æˆŒ": "è¾°",
            "å·³": "äº¥", "äº¥": "å·³"
          };
          return opposites[branch] || "";
        },
        produces(x, y) {
          const produceMap = {
            "é‡‘": "æ°´",
            "æ°´": "æœ¨",
            "æœ¨": "ç«",
            "ç«": "åœŸ",
            "åœŸ": "é‡‘"
          };
          return produceMap[x] === y;
        },
        overcomes(x, y) {
          const overcomeMap = {
            "é‡‘": "æœ¨",
            "æœ¨": "åœŸ",
            "åœŸ": "æ°´",
            "æ°´": "ç«",
            "ç«": "é‡‘"
          };
          return overcomeMap[x] === y;
        },
        getChongJian(index) {
          let liu = this.currentHexagram.liuQin[index] || "";
          if (!liu) return "";
          let lineBranch = liu.charAt(0);
          let resultsGround = [];
          let resultsFive = [];
          let dayBranch = this.today.dayDi;
          let monthBranch = this.today.monthDi;
          if (dayBranch) {
            if (this.getOpposite(dayBranch) === lineBranch) {
              if(this.showDayGround) resultsGround.push("æ—¥æ²–");
            } else if (dayBranch === lineBranch) {
              if(this.showDayGround) resultsGround.push("æ—¥å»º");
            }
          }
          if (monthBranch) {
            if (this.getOpposite(monthBranch) === lineBranch) {
              if(this.showMonthGround) resultsGround.push("æœˆæ²–");
            } else if (monthBranch === lineBranch) {
              if(this.showMonthGround) resultsGround.push("æœˆå»º");
            }
          }
          let dayElem = this.branchToElement[dayBranch] || "";
          // å¦‚æœè™•æ–¼è½‰åœŸæœŸï¼Œå¼·åˆ¶ä½¿ç”¨åœŸå…ƒç´ 
          let monthElem;
          if (this.today.isEarthPeriod) {
            monthElem = "åœŸ";  // è½‰åœŸæœŸé–“ï¼Œæœˆäº”è¡Œç‚ºåœŸ
          } else {
            monthElem = this.branchToElement[monthBranch] || "";
          }
          let lineElem = this.branchToElement[lineBranch] || "";
          if (dayBranch) {
            if (dayElem === lineElem) {
              if(this.showDayFive) resultsFive.push("æ—¥æ—º");
            } else if (this.produces(dayElem, lineElem)) {
              if(this.showDayFive) resultsFive.push("æ—¥ç›¸");
            } else if (this.produces(lineElem, dayElem)) {
              if(this.showDayFive) resultsFive.push("æ—¥ä¼‘");
            } else if (this.overcomes(dayElem, lineElem)) {
              if(this.showDayFive) resultsFive.push("æ—¥å›š");
            }
          }
          if (monthBranch) {
            if (monthElem === lineElem) {
              if(this.showMonthFive) resultsFive.push("æœˆæ—º");
            } else if (this.produces(monthElem, lineElem)) {
              if(this.showMonthFive) resultsFive.push("æœˆç›¸");
            } else if (this.produces(lineElem, monthElem)) {
              if(this.showMonthFive) resultsFive.push("æœˆä¼‘");
            } else if (this.overcomes(monthElem, lineElem)) {
              if(this.showMonthFive) resultsFive.push("æœˆå›š");
            }
          }
          return resultsGround.concat(resultsFive).join("/");
        },
        getEmptyDescription(index) {
          let liu = this.currentHexagram.liuQin[index] || "";
          if (!liu) return "";
          let lineBranch = liu.charAt(0);
          let kong = this.dayKongWang;
          if (kong && kong.indexOf(lineBranch) !== -1) {
            return "æ—¥ç©º";
          }
          return "";
        },
        getMonthEmptyDescription(index) {
          let liu = this.currentHexagram.liuQin[index] || "";
          if (!liu) return "";
          let lineBranch = liu.charAt(0);
          let kong = this.monthKongWang;
          if (kong && kong.indexOf(lineBranch) !== -1) {
            return "æœˆç©º";
          }
          return "";
        },
        getGanzhi(index) {
          return this.heavenlyStems[index % 10] + this.earthlyBranches[index % 12];
        },
        getYearGanzhi(date) {
          const solar = Solar.fromYmd(date.getFullYear(), date.getMonth() + 1, date.getDate());
          const lunar = solar.getLunar();
          return lunar.getYearInGanZhi();
        },
        getMonthGanzhi(date) {
          const solar = Solar.fromYmd(date.getFullYear(), date.getMonth() + 1, date.getDate());
          const lunar = solar.getLunar();
          return lunar.getMonthInGanZhi();
        },
        getDayGanzhi(date) {
          const solar = Solar.fromYmd(date.getFullYear(), date.getMonth() + 1, date.getDate());
          const lunar = solar.getLunar();
          return lunar.getDayInGanZhi();
        },
        getLunarDate(date) {
          const solar = Solar.fromYmd(date.getFullYear(), date.getMonth() + 1, date.getDate());
          const lunar = solar.getLunar();
          const isLeap = (typeof lunar.isLeap === 'function') ? lunar.isLeap() : lunar.isLeap;

          return {
            year: lunar.getYear(),
            month: lunar.getMonth(),
            day: lunar.getDay(),
            isLeapMonth: isLeap,
            monthDays: this.getLunarMonthDaysCount(lunar)
          };
        },
        getLunarMonthDaysCount(lunar) {
          // é€šéå˜—è©¦å‰µå»ºæ—¥æœŸä¾†åˆ¤æ–·æœˆä»½å¤©æ•¸
          const year = lunar.getYear();
          const month = lunar.getMonth();
          const isLeap = (typeof lunar.isLeap === 'function') ? lunar.isLeap() : lunar.isLeap;

          try {
            Lunar.fromYmd(year, month, 30, isLeap ? 1 : 0);
            return 30;
          } catch (e) {
            return 29;
          }
        },
        isInEarthTransformationPeriod(lunarMonth, lunarDay, monthDays) {
          // åªé©ç”¨æ–¼ 3ã€6ã€9ã€12 æœˆ
          const earthMonths = [3, 6, 9, 12];
          if (!earthMonths.includes(lunarMonth)) {
            return { isEarth: false, info: "" };
          }

          // æœ€å¾Œ 18 å¤© = å¾ç¬¬ (monthDays - 17) å¤©åˆ°ç¬¬ monthDays å¤©
          // ä¾‹å¦‚ï¼š30 å¤©çš„æœˆä»½ â†’ 13-30 æ—¥ï¼ˆ18 å¤©ï¼‰
          //       29 å¤©çš„æœˆä»½ â†’ 12-29 æ—¥ï¼ˆ18 å¤©ï¼‰
          const startDay = monthDays - 17;
          const isEarth = lunarDay >= startDay;

          if (isEarth) {
            const daysRemaining = monthDays - lunarDay + 1;
            return {
              isEarth: true,
              info: `æœˆä»¤è½‰åœŸï¼ˆè¾²æ›†${lunarMonth}æœˆå¾Œ18å¤©ï¼Œé‚„å‰©${daysRemaining}å¤©ï¼‰`
            };
          }

          return { isEarth: false, info: "" };
        },
        getLunarMonthName(month) {
          const monthNames = ['æ­£', 'äºŒ', 'ä¸‰', 'å››', 'äº”', 'å…­',
                              'ä¸ƒ', 'å…«', 'ä¹', 'å', 'åä¸€', 'åäºŒ'];
          return monthNames[month - 1] || month;
        },
        getLunarDayName(day) {
          const dayNames = {
            1: 'åˆä¸€', 2: 'åˆäºŒ', 3: 'åˆä¸‰', 4: 'åˆå››', 5: 'åˆäº”',
            6: 'åˆå…­', 7: 'åˆä¸ƒ', 8: 'åˆå…«', 9: 'åˆä¹', 10: 'åˆå',
            11: 'åä¸€', 12: 'åäºŒ', 13: 'åä¸‰', 14: 'åå››', 15: 'åäº”',
            16: 'åå…­', 17: 'åä¸ƒ', 18: 'åå…«', 19: 'åä¹', 20: 'äºŒå',
            21: 'å»¿ä¸€', 22: 'å»¿äºŒ', 23: 'å»¿ä¸‰', 24: 'å»¿å››', 25: 'å»¿äº”',
            26: 'å»¿å…­', 27: 'å»¿ä¸ƒ', 28: 'å»¿å…«', 29: 'å»¿ä¹', 30: 'ä¸‰å'
          };
          return dayNames[day] || day;
        },
        waitForLunarLibrary(retries = 10, delayMs = 300) {
          if (typeof Solar !== 'undefined') {
            this.lunarLibraryStatus = 'ready';
            this.initializeDate();
            return;
          }

          if (retries <= 0) {
            this.lunarLibraryStatus = 'error';
            console.error('lunar-javascript failed to load after retries.');
            return;
          }

          this.lunarLibraryStatus = 'loading';
          setTimeout(() => {
            this.waitForLunarLibrary(retries - 1, delayMs);
          }, delayMs);
        },

        initializeDate() {
          // ?ÂÃ¥??â€“Ã¯?Ã¨Â¨Â­Ã§Â½Â®Ã¤Â»Å Ã¥Â¤Â©?â€Ã¦â€”Â¥??
          this.today.solarDateInput = this.getTodayDateString();

          // Ã¨Â¨Ë†Ã§?Ã¤Â»Å Ã¥Â¤Â©?â€Ã¦??â€°Ã¤Â¿Â¡??
          const todayDate = new Date();
          this.calculateAllFromDate(todayDate);

          // Ã¨ÂªÂ¿Ã¨Â©Â¦Ã¨Â¼Â¸Ã¥â€¡Âº
          console.log('Mounted - Solar Date:', this.today.solarDateInput);
          console.log('Mounted - Year Ganzhi:', this.today.yearTian + this.today.yearDi);
          console.log('Mounted - Lunar Year:', this.today.lunarYear);
        },
        updateFromSolarDate() {
          // ç•¶ç”¨æˆ¶é¸æ“‡é™½æ›†æ—¥æœŸæ™‚è§¸ç™¼
          console.log('updateFromSolarDate called, value:', this.today.solarDateInput);

          if (!this.today.solarDateInput) {
            // å¦‚æœæ¸…ç©ºæ—¥æœŸï¼Œä½¿ç”¨ä»Šå¤©
            this.today.solarDateInput = this.getTodayDateString();
          }

          // è§£ææ—¥æœŸå­—ç¬¦ä¸²
          const parts = this.today.solarDateInput.split('-');
          const year = parseInt(parts[0]);
          const month = parseInt(parts[1]);
          const day = parseInt(parts[2]);

          // å‰µå»º Date å°è±¡
          const selectedDate = new Date(year, month - 1, day);

          // æ›´æ–°æ‰€æœ‰è¨ˆç®—çµæœ
          this.calculateAllFromDate(selectedDate);

          console.log('After update - Year:', this.today.yearTian + this.today.yearDi);
        },
        getTodayDateString() {
          // è¿”å› YYYY-MM-DD æ ¼å¼çš„ä»Šå¤©æ—¥æœŸå­—ç¬¦ä¸²
          const today = new Date();
          const year = today.getFullYear();
          const month = String(today.getMonth() + 1).padStart(2, '0');
          const day = String(today.getDate()).padStart(2, '0');
          return `${year}-${month}-${day}`;
        },
        calculateAllFromDate(date) {
          // çµ±ä¸€çš„è¨ˆç®—é‚è¼¯ï¼Œå¾ Date å°è±¡æ›´æ–°æ‰€æœ‰æ¬„ä½

          // 1. è¨ˆç®—å¹²æ”¯
          let yearGZ = this.getYearGanzhi(date);
          let monthGZ = this.getMonthGanzhi(date);
          let dayGZ = this.getDayGanzhi(date);

          this.today.yearTian = yearGZ.charAt(0);
          this.today.yearDi = yearGZ.charAt(1);
          this.today.monthTian = monthGZ.charAt(0);
          this.today.monthDi = monthGZ.charAt(1);
          this.today.dayTian = dayGZ.charAt(0);
          this.today.dayDi = dayGZ.charAt(1);

          // 2. è¨ˆç®—è¾²æ›†
          const lunarInfo = this.getLunarDate(date);
          this.today.lunarYear = lunarInfo.year;
          this.today.lunarMonth = lunarInfo.month;
          this.today.lunarDay = lunarInfo.day;
          this.today.isLeapMonth = lunarInfo.isLeapMonth;
          this.today.lunarMonthDays = lunarInfo.monthDays;

          // 3. æª¢æŸ¥è½‰åœŸæœŸ
          const earthCheck = this.isInEarthTransformationPeriod(
            lunarInfo.month,
            lunarInfo.day,
            lunarInfo.monthDays
          );
          this.today.isEarthPeriod = earthCheck.isEarth;
          this.today.earthPeriodInfo = earthCheck.info;
        },
        saveImage() {
          html2canvas(document.querySelector("#app")).then(canvas => {
            let link = document.createElement('a');
            link.download = 'æ˜“ç¶“å¦è±¡.png';
            link.href = canvas.toDataURL("image/png");
            link.click();
          });
        },
        copyPrompt() {
          const promptText = this.hexagramPrompt;

          // å˜—è©¦ä½¿ç”¨ç¾ä»£ Clipboard API
          if (navigator.clipboard && navigator.clipboard.writeText) {
            navigator.clipboard.writeText(promptText).then(() => {
              alert('âœ“ Prompt å·²è¤‡è£½åˆ°å‰ªè²¼ç°¿ï¼');
            }).catch(err => {
              console.error('è¤‡è£½å¤±æ•—:', err);
              this.copyPromptFallback(promptText);
            });
          } else {
            // é™ç´šæ–¹æ¡ˆ
            this.copyPromptFallback(promptText);
          }
        },
        copyPromptFallback(text) {
          // ä½¿ç”¨å‚³çµ±æ–¹æ³•è¤‡è£½
          const textarea = document.createElement('textarea');
          textarea.value = text;
          textarea.style.position = 'fixed';
          textarea.style.opacity = '0';
          document.body.appendChild(textarea);
          textarea.select();

          try {
            const successful = document.execCommand('copy');
            if (successful) {
              alert('âœ“ Prompt å·²è¤‡è£½åˆ°å‰ªè²¼ç°¿ï¼');
            } else {
              alert('âœ— è¤‡è£½å¤±æ•—ï¼Œè«‹æ‰‹å‹•é¸å–æ–‡å­—è¤‡è£½');
            }
          } catch (err) {
            console.error('è¤‡è£½å¤±æ•—:', err);
            alert('âœ— è¤‡è£½å¤±æ•—ï¼Œè«‹æ‰‹å‹•é¸å–æ–‡å­—è¤‡è£½');
          }

          document.body.removeChild(textarea);
        },
        selectAllPrompt(event) {
          // é»æ“Šæ™‚è‡ªå‹•å…¨é¸æ–‡å­—
          event.target.select();
        },
        getLiuQinRelation(gongElement, lineElement) {
          // æ ¹æ“šå¦å®®äº”è¡Œå’Œçˆ»äº”è¡Œåˆ¤å®šå…­è¦ªé—œä¿‚
          if (!gongElement || !lineElement) return "";

          if (gongElement === lineElement) {
            // åŒäº”è¡Œç‚ºå…„å¼Ÿ
            return "å…„å¼Ÿ";
          } else if (this.overcomes(gongElement, lineElement)) {
            // æˆ‘å…‹è€…ç‚ºå¦»è²¡
            return "å¦»è²¡";
          } else if (this.overcomes(lineElement, gongElement)) {
            // å…‹æˆ‘è€…ç‚ºå®˜é¬¼
            return "å®˜é¬¼";
          } else if (this.produces(gongElement, lineElement)) {
            // æˆ‘ç”Ÿè€…ç‚ºå­å­«
            return "å­å­«";
          } else if (this.produces(lineElement, gongElement)) {
            // ç”Ÿæˆ‘è€…ç‚ºçˆ¶æ¯
            return "çˆ¶æ¯";
          }

          return "";
        },
        // æ”¯å¦å°ˆç”¨åˆ¤å®šæ–¹æ³•
        getSupportChongJian(index) {
          // åªå°å‹•çˆ»é€²è¡Œåˆ¤å®š
          if (!this.lines[index].isMoving) {
            return "";
          }

          let liu = this.supportHexagram.liuQin[index] || "";
          if (!liu) return "";
          let lineBranch = liu.charAt(0);
          let resultsGround = [];
          let resultsFive = [];
          let dayBranch = this.today.dayDi;
          let monthBranch = this.today.monthDi;
          if (dayBranch) {
            if (this.getOpposite(dayBranch) === lineBranch) {
              if(this.showDayGround) resultsGround.push("æ—¥æ²–");
            } else if (dayBranch === lineBranch) {
              if(this.showDayGround) resultsGround.push("æ—¥å»º");
            }
          }
          if (monthBranch) {
            if (this.getOpposite(monthBranch) === lineBranch) {
              if(this.showMonthGround) resultsGround.push("æœˆæ²–");
            } else if (monthBranch === lineBranch) {
              if(this.showMonthGround) resultsGround.push("æœˆå»º");
            }
          }
          let dayElem = this.branchToElement[dayBranch] || "";
          // å¦‚æœè™•æ–¼è½‰åœŸæœŸï¼Œå¼·åˆ¶ä½¿ç”¨åœŸå…ƒç´ 
          let monthElem;
          if (this.today.isEarthPeriod) {
            monthElem = "åœŸ";  // è½‰åœŸæœŸé–“ï¼Œæœˆäº”è¡Œç‚ºåœŸ
          } else {
            monthElem = this.branchToElement[monthBranch] || "";
          }
          let lineElem = this.branchToElement[lineBranch] || "";
          if (dayBranch) {
            if (dayElem === lineElem) {
              if(this.showDayFive) resultsFive.push("æ—¥æ—º");
            } else if (this.produces(dayElem, lineElem)) {
              if(this.showDayFive) resultsFive.push("æ—¥ç›¸");
            } else if (this.produces(lineElem, dayElem)) {
              if(this.showDayFive) resultsFive.push("æ—¥ä¼‘");
            } else if (this.overcomes(dayElem, lineElem)) {
              if(this.showDayFive) resultsFive.push("æ—¥å›š");
            }
          }
          if (monthBranch) {
            if (monthElem === lineElem) {
              if(this.showMonthFive) resultsFive.push("æœˆæ—º");
            } else if (this.produces(monthElem, lineElem)) {
              if(this.showMonthFive) resultsFive.push("æœˆç›¸");
            } else if (this.produces(lineElem, monthElem)) {
              if(this.showMonthFive) resultsFive.push("æœˆä¼‘");
            } else if (this.overcomes(monthElem, lineElem)) {
              if(this.showMonthFive) resultsFive.push("æœˆå›š");
            }
          }
          return resultsGround.concat(resultsFive).join("/");
        },
        getSupportEmptyDescription(index) {
          // åªå°å‹•çˆ»é€²è¡Œåˆ¤å®š
          if (!this.lines[index].isMoving) {
            return "";
          }

          let liu = this.supportHexagram.liuQin[index] || "";
          if (!liu) return "";
          let lineBranch = liu.charAt(0);
          let kong = this.dayKongWang;
          if (kong && kong.indexOf(lineBranch) !== -1) {
            return "æ—¥ç©º";
          }
          return "";
        },
        getSupportMonthEmptyDescription(index) {
          // åªå°å‹•çˆ»é€²è¡Œåˆ¤å®š
          if (!this.lines[index].isMoving) {
            return "";
          }

          let liu = this.supportHexagram.liuQin[index] || "";
          if (!liu) return "";
          let lineBranch = liu.charAt(0);
          let kong = this.monthKongWang;
          if (kong && kong.indexOf(lineBranch) !== -1) {
            return "æœˆç©º";
          }
          return "";
        }
      },
      mounted() {
        this.waitForLunarLibrary();
      }
    });
  </script>
</body>
</html>
